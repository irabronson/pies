/* ========================================

  BASELINE, RESET

=========================================== */


h1,
h2,
ul,
figure {
  margin: 0;
  padding: 0;
}

button {
  font-family: inherit; /* Most form elements don't inherit by default */
  background: none;
  border: none;
  margin: 0;
  padding: 0;
  font-weight: 600;
  color: var(--color-primary);
}

p {
  margin: 0 0 1.2em;
}

li {
  display: inline;
}

video,
img {
  width: 100%;
  height: auto;
  vertical-align: middle;
}


/* ========================================

  FOUNDATIONS

=========================================== */


/* -------- Defining variables */

:root {
  /* Colors */
  --color-primary: #000;
  --color-secondary: #8c8c8c;
  --color-light: #f3f3f3;
  /* Typography */
  --text-large: clamp(72px, 10.106vw, 164px);
  --text-medium: clamp(38px, 5.186vw, 84px);
  --text-small: clamp(24px, 2.393vw, 40px);
  --text-body: clamp(20px, 1.5vw, 24px);
  --letter-spacing-tightest: -0.04em;
  --letter-spacing-tighter: -0.03em;
  --letter-spacing-tight: -0.02em;
  /* Spacing */
  --spacing-large: 20%;
  --spacing-medium: 12%;
  --spacing-small: 6%;
  --spacing-xsmall: 2%;
  /* Border */
  --border-link: 0.12em solid var(--color-primary);
  --border-device: 0.25em solid var(--color-primary);
  /* Border radius */
  --border-radius: 0.65em;
  /* Widths */
  --page-container: 94%;
  --device-width-full: 100%;
  --device-width-large: 28%;
  --device-width-small: 22%;
}


/* -------- Body */

body {
  padding: 0;
  margin: 0;
  background: var(--color-light);
  /* 20px up to 1333 > vw > 24px @1600 */
  font: 600 var(--text-body)/1.3 Helvetica, Arial, sans-serif;
  letter-spacing: var(--letter-spacing-tight);
  /* Improves font display by rendering the weight correctly
  Appearance is too thick without it */
  -webkit-font-smoothing: antialiased; /* Chrome, Safari */
  -moz-osx-font-smoothing: grayscale; /* Firefox on MacOS */
}


/* -------- Typography, Links */

h1 {
  font-size: var(--text-large);
  letter-spacing: var(--letter-spacing-tightest);
  line-height: 1;
}

h2 {
  font-size: var(--text-medium);
  letter-spacing: var(--letter-spacing-tightest);
  line-height: 1;
}

#filters *,
.description a,
#download *,
footer p {
  font-size: var(--text-small);
  letter-spacing: var(--letter-spacing-tighter);
}

a:link,
a:visited,
a:active {
  position: relative;
  color: var(--color-primary);
  text-decoration: none;
  padding-bottom: 0.1em;
  border-bottom: var(--border-link);
  transition: padding-right 0.3s cubic-bezier(0.7, 0, 0, 0.9);
}

#filters a:link,
#filters a:visited,
#filters a:active {
  color: var(--color-secondary);
  border-color: transparent;
  transition: color 0.2s;
  transform: translateZ(0); /* Need for Safari */
}

#filters a.active {
  color: var(--color-primary);
  border-bottom: var(--border-link);
}

/* Show link hover if 800 and up */

@media (min-width:800px) {

  a:hover:not(#filters a) {
    padding-right: 0.9em;
  }
  
  a:not(#filters a) span {
    position: absolute;
    top: 0.25em;
    margin-left: 0.2em;
    width: 0.7em;
    height: 0.7em;
    overflow: hidden;
    pointer-events: none;
  }
  
  /* Adjusting that ^ span/icon position in Firefox */
  @-moz-document url-prefix() {
    a:not(#filters a) span {
      top: 0.1em;
    }
  }
  
  a:not(#filters a) span::after {
    display: block;
    width: 0.7em;
    height: 0.7em;
    content: "";
    background: url(/img/icon-arrow.svg) no-repeat 50% 50%;
    background-size: 1em;
    transform: rotate(90deg);
    translate: -0.7em;
    transition: translate 0.3s cubic-bezier(0.7, 0, 0, 0.9);
  }
  
  a:hover:not(#filters a) span::after {
    translate: 0;
  }
  
  #filters a:hover {
    color: var(--color-primary);
  }
  
}

/* -------- Page, Sections */

.page-container {
  width: var(--page-container);
  margin-inline: auto;
}

header {
  margin-top: var(--spacing-xsmall);  
}

nav {
  margin: var(--spacing-xsmall) 0 var(--spacing-small);
  scroll-margin: 1.4vw; /* scrollIntoView target */
}

.page-section {
  margin-bottom: var(--spacing-medium);
}

.transition {
  opacity: 0;
}


/* -------- Nav filters */

#filters li:not(:last-child) {
  margin-right: 0.5em;
}



/* ========================================

  FIXED FILTER INTERACTIONS

=========================================== */


/* -------- Show/hide filters on scroll */

nav .fixed {
  position: fixed;
  top:  1.6vw;
  left: 4vw;
  z-index: 2;
  display: flex;
  border-radius: 64px;
  background: var(--color-light);
  visibility: hidden;
  opacity: 0;
  transform: translateY(-2vw);
  transition: transform 0.2s, opacity 0.2s, visibility 0s 0.2s;
}

nav.hidden .fixed {
  visibility: visible;
  opacity: 1;
  transform: translateY(0);
  transition-delay: 0.2s;
}

/* -------- Open/close filters */

nav .fixed button,
nav .fixed ul {
  padding: 0.4em 1em;
}

nav .fixed button {
  position: relative;
  z-index: 2;
  line-height: inherit;
  cursor: pointer;
  opacity: 1;
}

nav .fixed.open button {
  padding-right: 0;
  opacity: 0;
}

nav .fixed ul {
  opacity: 0;
  display: none;
}

nav .fixed.open ul {
  display: block;
  padding-left: 0;
  animation: filter-list-in 0.2s cubic-bezier(0.3, 0, 0.2, 1) forwards;
}

nav .fixed .label::before {
  background: url('/img/icon-close.svg') no-repeat; 
  position: absolute;
  left: 1.5em;
  top: 0.7em;
  z-index: 1;
  width: 0.8em;
  height: 0.8em;
  background-size: 0.8em 0.8em;
  transform: scale(0);
  content: "";
}

nav .fixed.open .label::before {
  transform: scale(1);
  transition: transform 0.2s;
}

@keyframes filter-list-in {
  0% {
    opacity: 0;
    transform: translate3d(-1vw, 0, 0);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

/* -------- Setting immediate dismissal of nav upon close to override its animation */

nav .fixed.dismiss {
  transition: none;
  visibility: hidden;
}



/* ========================================

  ANIMATIONS

=========================================== */


/* -------- Intro */

.intro {
  position: fixed;
  top: 0;
  left: 0;
  z-index: 3;
  width: 100%;
  height: 100dvh;
  overflow: hidden; /* For zeroHeight */
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  grid-template-rows: repeat(3, 1fr);
  animation: zeroHeight 0s 2.8s forwards;
}

@keyframes zeroHeight {
  /* Collapsing container to get it out da way */
  0% {
    height: 100vh;
  }
  100% {
    height: 0;
  }
}

/* Variable values to calculate an animation-delay */ 
.intro span:nth-child(4) { --intro-order: 1; }
.intro span:nth-child(6) { --intro-order: 2; }
.intro span:nth-child(1) { --intro-order: 3; }
.intro span:nth-child(8) { --intro-order: 4; }
.intro span:nth-child(15) { --intro-order: 5; }
.intro span:nth-child(2) { --intro-order: 6; }
.intro span:nth-child(9) { --intro-order: 7; }
.intro span:nth-child(13) { --intro-order: 8; }
.intro span:nth-child(5) { --intro-order: 9; }
.intro span:nth-child(11) { --intro-order: 10; }
.intro span:nth-child(7) { --intro-order: 11; }
.intro span:nth-child(16) { --intro-order: 12; }
.intro span:nth-child(14) { --intro-order: 13; }
.intro span:nth-child(12) { --intro-order: 14; }
.intro span:nth-child(10) { --intro-order: 15; }
.intro span:nth-child(3) { --intro-order: 16; }


/* Initial animation - In */ 
.intro span {
  background: url("/img/icon-pie.svg") no-repeat center;
  background-size: 8vw;
  animation: introIn 1s calc(var(--intro-order) * 0.04s) backwards;
}

/* Second animation - Out */ 
.intro span.out {
  animation: introOut 0.4s cubic-bezier(0.7, 0, 0.2, 0.9) forwards;
}

/* Sequential delays for Out exit */ 
.intro span.out:nth-child(1) { animation-delay: 0.7s; }
.intro span.out:nth-child(2) { animation-delay: 0.65s; }
.intro span.out:nth-child(3) { animation-delay: 0.6s; }
.intro span.out:nth-child(4) { animation-delay: 0.55s; }
.intro span.out:nth-child(5) { animation-delay: 0.5s; }
.intro span.out:nth-child(6) { animation-delay: 0.45s; }
.intro span.out:nth-child(7) { animation-delay: 0.4s; }
.intro span.out:nth-child(8) { animation-delay: 0.35s; }
.intro span.out:nth-child(9) { animation-delay: 0.3s; }
.intro span.out:nth-child(10) { animation-delay: 0.25s; }
.intro span.out:nth-child(11) { animation-delay: 0.2s; }
.intro span.out:nth-child(12) { animation-delay: 0.15s; }
.intro span.out:nth-child(13) { animation-delay: 0.1s; }
.intro span.out:nth-child(14) { animation-delay: 0.05s; }
.intro span.out:nth-child(15) { animation-delay: 0.02s; }
.intro span.out:nth-child(16) { animation-delay: 0s; }

/* Redefine grid as 4x4 for small screens */
@media (max-width:799px) {
  .intro {
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
  }
}

@keyframes introIn {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

@keyframes introOut {
  0% {
    opacity: 1;
    transform: translateY(0);
  }
  70% {
    opacity: 0;
  }
  100% {
    opacity: 0;
    transform: translateY(12vw);
  }
}

/* -------- Full page/content */

.animate-in {
  opacity: 0;
  animation: animate-in 0.5s cubic-bezier(0.3, 0, 0.2, 1) 2.2s forwards;
}

.animate-in.step-2 {
  animation-delay: 2.25s;
}

.animate-in.step-3 {
  animation-delay: 2.3s;
}

@keyframes animate-in {
  0% {
    opacity: 0;
    transform: translate3d(0, 12vw, 0);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

/* -------- Delaying display of filter and back to top so they don't appear on a scrolled page reload */

nav .fixed.hide,
#back-to-top-container.hide {
  opacity: 0;
  transition: 0s;
}

#back-to-top-container {
  transition: opacity 0.2s 0.2s;
}

/* -------- Letters in / Split elements */

.letters-in {
  margin-left: -4%;
  font-size: 53vw;
  letter-spacing: -0.06em;
  line-height: 0.8;
}

.split {
  display: flex;
  width: var(--page-container);
  height: 100%;
}

/* Because Firefox renders text baseline or vertical alignment differently (really only noticeable at these large sizes), the letters are sitting higher in the text containing block, so adding padding for Firefox. */
@-moz-document url-prefix() {
  .split {
    padding-top: 7vw;      
  }
}

.split span {
  opacity: 0;
  animation: split 1s cubic-bezier(0.5, 0.2, 0.1, 1) forwards;
}

.intro .split span {
  background: url("/img/icon-pie.svg") no-repeat center;
  background-size: 98%;
  flex-grow: 1;
}

.letters-in span {
  /* For triggering via IO and need this starting state */
  opacity: 0;
}

.split span:nth-child(2) {
  animation-delay: 0.07s;
}

.split span:nth-child(3) {
  animation-delay: 0.14s;
}

.split span:nth-child(4) {
  animation-delay: 0.21s;
}

.split span:nth-child(5) {
  animation-delay: 0.28s;
}

@keyframes split {
  0%, 30% {
    opacity: 0;
    transform: translate3d(0, 32vw, 0);
  }
  80% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}



/* ========================================

  GRID LAYOUT, ITEMS

=========================================== */


#category-collection {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
}

.category-item {
  width: var(--device-width-small);
  margin-top: var(--spacing-small);
  margin-bottom: var(--spacing-small);
}

figure {
  border: var(--border-device);
  border-radius: var(--border-radius);
  overflow: hidden;
  transform: translateZ(0); /* Need for overflow: hidden to work in Safari */
}


/* -------- Device / Phones */

.phone .description {
  margin-top: var(--spacing-small);
}

/* Big phone */
:nth-child(4n + 1 of .phone) {
  width: var(--device-width-large);
  margin-right: var(--spacing-large);
}

/* Small phone centered */
:nth-child(8n + 4 of .phone) {
  margin-left: var(--spacing-large);
}


/* -------- Device / Desktop */

.desktop {
  width: var(--device-width-full);
  margin-left: var(--spacing-medium);
  margin-right: var(--spacing-medium);	
}

.desktop-container {
  display: flex;
  align-items: center;
  gap: 4%;
}

.desktop-container.right {
  flex-direction: row-reverse;
}

.desktop .description {
  width: 60%;
  max-width: 560px
}


/* ========================================

  SECTION-SPECIFIC STYLING (S³)

=========================================== */


#category-content {
  min-height: 100vh;
}

.letters-in.page-section {
  /* Accounting for the .category-item bottom-margin that can't be consistently targeted with :last-child */
  /* Note the calc var * -1 to get the negative value */
  margin-top: calc(var(--spacing-small) * -1);
}

#download p {
  margin-top: 0.4%; /* Need a one-off, man */
}

#about {
  width: clamp(420px, 32%, 600px);
}



/* ========================================

  INTERACTIVE FEATURES

=========================================== */


/* -------- Back to top */

/* Common to all screens */

.back-to-top {
  background: var(--color-light) url("/img/icon-arrow.svg") no-repeat center;
  display: block;
  border-radius: 50%;
  overflow: hidden;
  padding: 80px 40px 0;
  height: 0;
  width: 0;
	opacity: 0;
	visibility: hidden;
	cursor: pointer;
  transform: translateY(2vw);
	transition: opacity 0.2s, visibility 0s 0.2s, transform 0.2s;
}

.back-to-top.scrolled {
	opacity: 1;
	visibility: visible;
  transform: translateY(0);
	transition-delay: 0s;
}

/* Small screens */
@media (max-width:560px) {
  #back-to-top-container {
    margin: var(--spacing-large) 0;
    display: flex;
    justify-content: center;
  }
}

/* Desktop */
@media (min-width:561px) {
  #back-to-top-container {
  	position: fixed;
  	right: 4vw;
  	top: 1.6vw;
  	z-index: 2;
  }
  .back-to-top:hover {
    transform: translateY(-0.4vw);
  }
}


/* -------- QR code - Desktop only */

.qr-container {
  display: none;
}

/* Show it if 800 and up */

@media (min-width:800px) {

  .qr-container {
    display: block;
    position: absolute;
    left: 1vw;
    bottom: 1vw;
    z-index: 1;
    width: 42px;
    height: 42px;
    background: #fff;
    border-radius: 4px 4px 4px 2px;
    filter: drop-shadow(0 4px 6px rgb(0 0 0 / 0.08));
    transform-origin: bottom left;
    transform: scale(1);
    transition: transform 0.15s;
    cursor: pointer;
  }
  
  .category-item.phone figure::before,
  .category-item.phone figure::after {
    position: absolute;
    left: calc(1vw + 10px);
    bottom: calc(1vw + 10px);
    z-index: 2;
    width: 22px;
    height: 22px;
    content: "";
    background-size: 22px 22px;
    transition: transform 0.15s;
    pointer-events: none;
  }

  .category-item.phone figure::before {
    background-image: url('/img/icon-qrcode.svg'); 
  }

  .category-item.phone figure::after {
    background-image: url('/img/icon-close.svg');
    transform: scale(0);
  }

  .qr-img {
    padding: 15% 15% 22%;
    box-sizing: border-box;
    opacity: 0;
    transition: opacity 0.1s;
    transform: translateZ(0); /* Need for Safari to display the image properly when scaled */
  }
  
  .open .qr-container {
    height: auto;
    transform: scale(4);
  }

  .category-item.phone figure.open::before {
    transform: scale(0);
  }
  
  .category-item.phone figure.open::after {
    transform: scale(1);
    transition-delay: 0.07s;
  }
  
  .category-item.phone figure.open .qr-img {
    opacity: 1;
  }

}

/* Bigger QR image 1200 and up */

@media (min-width:1200px) {

  .open .qr-container {
    transform: scale(5);
  }

}

/* Bigger icon 1600 and up */

@media (min-width:1600px) {

  .qr-container {
    width: 48px;
    height: 48px;
    /* border-radius: 8px; */
  }

  .category-item.phone figure::before,
  .category-item.phone figure::after {
    width: 28px;
    height: 28px;
    background-size: 28px 28px;
  }

}


/* ========================================

  SMALL SCREENS

=========================================== */


@media (max-width:560px) {
  
  :root {
    /* Device widths */
    --device-width-large: 75%;
    --device-width-small: 65%;
  }
  
  .page-container {
    width: 90%;
  }
  
  nav.page-container {
    top: 0;
    background: var(--color-light);
    margin-left: 0;
    margin-right: 0;
    padding: 8% 5%;
    overflow-x: scroll;
  }

  nav.page-container.nav-sticky {
    border-bottom: var(--border-link);
  }
  
  nav ul {
    width: max-content;
  }
  
  nav > ul {
    padding-right: 5%;
  }
  
  nav .fixed li {
    display: flex;
  }
  


  :nth-child(4n + 1 of .phone) {
    margin-right: 0;
  }
  
  .desktop-container {
    display: initial;
  }
  
  .desktop .description {
    width: initial;
  }
  
  #category-content {
    scroll-margin: 14vh;
  }

  #about {
    width: 100%;
  }
  
}